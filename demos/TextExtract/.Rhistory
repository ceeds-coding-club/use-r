break
}
}
x<-centre-0.01 #-value must equal increment value from above
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.01
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-5,8),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.38, 4.52)
height<-c(10, 5, 2, 1.5, 3)
sd<-c(1, 1, 1, 1, 1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.5 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.5 #-value must equal increment value from above
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.5
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-5,8),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.38, 4.52)
height<-c(10, 5, 2, 1.5, 3)
sd<-c(1, 1, 1, 1, 1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.5 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.5 #-value must equal increment value from above
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.5
if (y<0.05){
break
}
}
xvalues
yvalues
plotdata<-data.frame(xvalues,yvalues)
plotdata
ordereddata<-plotdata[order(xvalues),]
ordereddata
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(1, 1, 1, 1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.5 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.5 #-value must equal increment value from above
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.5
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(0.5, 0.5, 0.5, 0.5)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.5 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.5 #-value must equal increment value from above
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.5
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_point()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(0.1, 0.1, 0.1, 0.1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.01 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.01 #-value must equal increment value from above & below
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.01 #increment value to match above
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-10,10),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(-5,8),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(3,6),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata
?ddply
plotdata
?aggregate
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(0.1, 0.1, 0.1, 0.1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.01 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.01 #-value must equal increment value from above & below
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.01 #increment value to match above
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-aggregate(plotdata['yvalues'],plotdata['xvalues'],sum)
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(0.1, 0.1, 0.1, 0.1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.01 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.01 #-value must equal increment value from above & below
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.01 #increment value to match above
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-aggregate(plotdata,plotdata['xvalues'],sum)
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata
# set peaks in R
centre<-c(5.98, 4.03, -4.5, 4.52)
height<-c(10, 5, 2, 3)
sd<-c(0.1, 0.1, 0.1, 0.1)
x<-centre
yvalues<-c()
xvalues<-c()
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x+0.01 #increment value to match below
if (y<0.05){
break
}
}
x<-centre-0.01 #-value must equal increment value from above & below
repeat {
y=height*exp(-(((x-centre)^2)/(2*sd)^2))
yvalues<-append(yvalues,y)
xvalues<-append(xvalues,x)
x = x-0.01 #increment value to match above
if (y<0.05){
break
}
}
plotdata<-data.frame(xvalues,yvalues)
summedplotdata<-aggregate(y~x,data=plotdata,FUN=sum)
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata<-aggregate(yvalues~xvalues,data=plotdata,FUN=sum)
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata<-tapply(plotdata$yvalues, plotdata$xvalues, FUN=sum)
ggplot(summedplotdata, aes(xvalues,yvalues))+
geom_line()+
scale_x_continuous(name="Chemical Shift (ppm)",
limits=c(4,5),
breaks=seq(-30,30,5),
labels=c(-30,"",-20,"",-10,"",0,"",10,"",20,"",30))+
theme_classic()+
theme(axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank())
summedplotdata
summedplotdata<-data.frame(tapply(plotdata$yvalues, plotdata$xvalues, FUN=sum))
summedplotdata
summedplotdata<-aggregate(plotdata,plotdata$xvalues,FUN=sum)
summedplotdata<-aggregate(plotdata,list(plotdata$xvalues),FUN=sum)
summedplotdata
summedplotdata<-aggregate(plotdata$yvalues,list(plotdata$xvalues),FUN=sum)
summedplotdata
summedplotdata<-aggregate(plotdata$yvalues,by=list(xvalues=plotdata$xvalues),FUN=sum)
summedplotdata
print(summedplotdata[1,])
summedplotdata<-aggregate(plotdata,by=list(xvalues=plotdata$xvalues),FUN=sum)
summedplotdata
?ddply
summedplotdata<-ddply(plotdata, "xvalues", numcolwise(sum))
summedplotdata
summedplotdata<-rowsum(plotdata,xvalues)
summedplotdata
summedplotdata<-rowsum(plotdata,"xvalues")
summedplotdata<-rowsum(plotdata,plotdata$xvalues)
summedplotdata
summedplotdata<-colsum(plotdata,plotdata$xvalues)
summedplotdata<-colSums(plotdata,plotdata$xvalues)
summedplotdata
summedplotdata<-ddply(plotdata,~yvalues,summarise,xvalues=sum(xvalues))
summedplotdata
summedplotdata<-ddply(plotdata,~xvalues,summarise,yvalues=sum(yvalues))
summedplotdata
?ddply
summedplotdata<-ddply(plotdata,~yvalues,summarise,xvalues=sum(xvalues))
summedplotdata
summedplotdata<-ddply(plotdata,~yxvalues,summarise,yvalues=sum(yvalues))
summedplotdata<-ddply(plotdata,~xvalues,summarise,yvalues=sum(yvalues))
summedplotdata
library(av)
library(magick)
library(tesseract)
### path for folder containing all videos ### set path as working directory
path<-"C:/Users/rober115/OneDrive - Lancaster University/Example"
setwd(path)
### select folder
folder<-"x"
### make a list of image files
files<-list.files(path=paste0(path, "/",folder), pattern="*.png")
### make a starting data frame (empty with only column names)
output<-data.frame(matrix(ncol=8,nrow=0, dimnames=list(NULL, c("c8", "c1", "c2", "c3", "c4", "c5", "c6", "c7"))))
### check cropping on 1st image (need to look at each crop and alter location)
img<-image_read(paste0(path, "/", folder, "/", "image_000001.png"))
##### width ##### height ##### x coord ##### y coord #####
image_crop(img, "200x100+290+150") # crop1
##### width ##### height ##### x coord ##### y coord #####
image_crop(img, "200x100+290+110") # crop1
##### width ##### height ##### x coord ##### y coord #####
image_crop(img, "200x100+290+150") # crop1
image_negate(image_crop(img, "340x30+530+703")) # timestamp
### whitelist (for values)
whitelist1 <- tesseract(options = list(tessedit_char_whitelist = ".0123456789"))
whitelist2 <- tesseract(options = list(tessedit_char_whitelist = ".:/0123456789"))
for (f in files) {
### read in each image
img <- image_read(f)
### crop diff parts of image ### REMEMBER TO MATCH THESE CROPS TO ABOVE
crop1<-image_crop(img, "200x100+290+150")
crop2<-image_crop(img, "200x100+290+240")
crop3<-image_crop(img, "200x100+290+325")
crop4<-image_crop(img, "200x100+290+420")
crop5<-image_crop(img, "200x100+930+145")
crop6<-image_crop(img, "200x100+930+235")
crop7<-image_crop(img, "200x100+930+330")
crop8<-image_negate(image_crop(img, "340x30+530+703"))
### extract text from crops and remove \n
c1<-gsub("[\n]", "",ocr(crop1, engine=whitelist1))
c2<-gsub("[\n]", "",ocr(crop2, engine=whitelist1))
c3<-gsub("[\n]", "",ocr(crop3, engine=whitelist1))
c4<-gsub("[\n]", "",ocr(crop4, engine=whitelist1))
c5<-gsub("[\n]", "",ocr(crop5, engine=whitelist1))
c6<-gsub("[\n]", "",ocr(crop6, engine=whitelist1))
c7<-gsub("[\n]", "",ocr(crop7, engine=whitelist1))
c8<-gsub("[\n]", "",ocr(crop8, engine=whitelist2))
### make a data frame of extracted text
extracted<-data.frame(f, c8, c1, c2, c3, c4, c5, c6, c7)
### add data frame to starting data frame
output<-rbind(output, extracted)
### print image to show progress
print(f)
}
image_crop(img, "200x100+930+235") # crop6
image_negate(image_crop(img, "340x30+530+703")) # timestamp
image_crop(img, "200x100+930+235") # crop6
